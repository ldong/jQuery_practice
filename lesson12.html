<!doctype html>
<html>
<head>
    <title>Lesson 12</title>
</head>
<body>
<script src="http://code.jquery.com/jquery-2.1.1.js"></script>
<script>
var myVar;
var setVal = function(){
    var deferred = $.Deferred();
    setTimeout(function(){
        myVar = 'my value';
        deferred.resolve();
        // if needed
        // deferred.reject(); 
        
    }, 2000);

    return deferred.promise();
}

//setVal().done(function(){
//setVal().fail(function(){
setVal().always(function(){
    console.log('all done '+ myVar);
});


// chaining
setVal().done(function(){
    console.log('done' + myVar);
}).fail(function(){
    console.log('done' + myVar);
});

setVal().then(
    function(){
        console.log('done' + myVar); // resolve
    },
    function(){
        console.log('done' + myVar); // fail
    }
);

$.searchTwitter = function(search){
//    var dfd = new $.Deferred();
//    $.ajax({
//        url: 'https://search.twitter.com/search.json',
//        data: {q: search},
//        dataType: 'jsonp',
//        success: dfd.resolve
//        error: dfd.reject
//    })   
//    return dfd.promise();
    
    //or just do this 
    return $.ajax({
        url: 'https://search.twitter.com/search.json',
        data: {q: search},
        dataType: 'jsonp'
    }).promise();
}

var outer = $.searchTwitter('cats');

outer.then(function(results){
    console.log(results);
});

outer.then(function(){
    console.log('something else');
});



</script>
</body>
</html>
